"0","## Model setup"
"0",""
"0","library(mvtnorm)"
"0","n=300 # sample size"
"0","p=1000 # dimension"
"0","lambda = 10000 # hyper-parameter in the prior"
"0","full.model <- 1:p "
"0","rho = 0.2 # correlation between each pair of adjacent covariates"
"0","# covariance matrix for covariate matrix: X. "
"0","Sig_x = rho^(abs(matrix(full.model,p,p)-t(matrix(full.model,p,p)))) "
"0","set.seed(1000) # set random seed"
"0","var.true <- c(1,5,10,15) # true model r^*"
"0","k.true=length(var.true) # size of true model r^*"
"0","Theta = rep(0,p) "
"0","theta.true <- c(1,1.5,2,-1) # values of true theta_r values"
"0","Theta[var.true] = theta.true"
"0","X = rmvnorm(n,rep(0,p),Sig_x,method=""chol"") # generate X from multivar-normal distribution"
"0","X[,1]<-rep(1,n) # make first column of X a 1 vector"
"0","eta = X%*%Theta"
"0","pi.true <- 1/(1+exp(-eta)) # prob of y = 1. "
"0","y = rbinom(n,size = 1,prob = pi.true) # response is from Bernoulli distribution. "
